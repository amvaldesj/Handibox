#!/usr/bin/python

import cv2.cv as cv
import numpy
import os
import time
import pickle, threading
from Process_manager import Process_manager
from FaceTracking import FaceTracking
#from MouseTweak import MouseTweak
 		
 		 		
class Camera:
	def __init__(self):
		pman = Process_manager()
		id_camera = int(pman.read_id())
		print id_camera
		self.id_device = id_camera
		self.width = 320
		self.height = 240
		self.capture = cv.CreateCameraCapture(self.id_device)
				
		if self.width is None:
			self.width = int(cv.GetCaptureProperty(capture, cv.CV_CAP_PROP_FRAME_WIDTH))
		else:
			cv.SetCaptureProperty(self.capture,cv.CV_CAP_PROP_FRAME_WIDTH,self.width)    

		if self.height is None:
			self.height = int(cv.GetCaptureProperty(self.capture, cv.CV_CAP_PROP_FRAME_HEIGHT))
		else:
			cv.SetCaptureProperty(self.capture,cv.CV_CAP_PROP_FRAME_HEIGHT,self.height) 

		result = cv.CreateImage((self.width,self.height),cv.IPL_DEPTH_8U,3)				

		
		faceTraking = FaceTracking()
		#mousetweak = MouseTweak()	
		#mousetweak.showMouseTweak()
		
		while True:
			image = cv.QueryFrame(self.capture)			
			show = faceTraking.detectFace(image)
			faceTraking.updateMousePos()
			cv.ShowImage("HandiMouse", image)
			k = cv.WaitKey(10);
			if k == 'f':
				break
				
	
		
	
if __name__=='__main__':
	start = Camera()   
	
